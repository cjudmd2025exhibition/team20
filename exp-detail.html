<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RIPPLE - 플로깅 상세</title>
  <meta name="description" content="작은 실천이 연결되는 친환경 플랫폼, RIPPLE" />
  <!-- Pretendard CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/static/pretendard.css" />
  <!-- Remixicon for icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Pretendard', 'ui-sans-serif', 'system-ui'] },
          colors: {
            brand: {
              50: '#e9faff',
              100: '#c9faff',
              200: '#a7f0ff',
              400: '#6be0ff',
              500: '#39c9ff',
              600: '#12a6e6'
            },
            ink: '#0f1115'
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,0.25)'
          }
        }
      }
    } 
  </script>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body class="experience-page text-white font-sans antialiased">

<!-- Header -->
<header class="header">
  <div class="header-inner">
    <a href="./index.html" class="logo">
      <img src="./assets/logo.png" alt="RIPPLE" class="logo-img">
    </a>
    <nav class="nav">
      <a href="./index.html">HOME</a>
      <a href="./about.html">ABOUT</a>
      <a href="./guide.html">GUIDE</a>
      <a href="./experience.html">EXPERIENCE</a>
    </nav>
    <button id="menuBtn" class="menu-btn" aria-label="메뉴 열기">☰</button>
  </div>
  <div id="mobileMenu" class="mobile-menu" aria-hidden="true">
    <a href="./index.html">HOME</a>
    <a href="./about.html">ABOUT</a>
    <a href="./guide.html">GUIDE</a>
    <a href="./experience.html">EXPERIENCE</a>
  </div>
</header>

<main class="experience">
  <div class="experience-inner">
    <h2 class="experience-title breadcrumb" aria-label="breadcrumb">
      <a href="./experience.html" class="crumb is-root">library</a>
      <span class="sep" aria-hidden="true">›</span>
      <span class="crumb is-muted">플로깅</span>
    </h2>
    
    <!-- 검색창 (비활성화) -->
    <div class="exp-detail-searchbox">
      <input type="text" placeholder="플로깅 갤러리" class="exp-detail-search" style="color: #1a1a1a !important; --placeholder-color: #1a1a1a;" disabled readonly>
    </div>
    
    <!-- exp01 갤러리 섹션 -->
    <section class="exp01">
      <div class="exp01-inner">
        <div class="exp-grid">
          <a href="./plogging/plogging-01.html" class="exp-card" data-post-id="original-1">
            <img src="./ploggingimg/01.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">가족끼리 플로깅 다녀왔어요</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-02.html" class="exp-card" data-post-id="original-2">
            <img src="./ploggingimg/02.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">리플 크루원들과 한강 플로깅!</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-03.html" class="exp-card" data-post-id="original-3">
            <img src="./ploggingimg/03.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">가을엔 플로깅</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-04.html" class="exp-card" data-post-id="original-4">
            <img src="./ploggingimg/04.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">춥지만 쓰레기부터 줍자</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-05.html" class="exp-card" data-post-id="original-5">
            <img src="./ploggingimg/05.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">퇴근길 10분 플로깅</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-06.html" class="exp-card" data-post-id="original-6">
            <img src="./ploggingimg/06.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">플로깅 첫 도전!</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-07.html" class="exp-card" data-post-id="original-7">
            <img src="./ploggingimg/07.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">주말 조깅 대신 플로깅</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-08.html" class="exp-card" data-post-id="original-8">
            <img src="./ploggingimg/08.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">강변길에서 주운 쓰레기 2kg 인증!</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-09.html" class="exp-card" data-post-id="original-9">
            <img src="./ploggingimg/09.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">#RIPPLE챌린지</span>
            <div class="exp-card__rule"></div>
          </a>
          <a href="./plogging/plogging-10.html" class="exp-card" data-post-id="original-10">
            <img src="./ploggingimg/10.png" alt="플로깅 활동" class="exp-card__img">
            <span class="exp-card__tag">오늘은 한강 플로깅</span>
            <div class="exp-card__rule"></div>
          </a>
        </div>
      </div>
    </section>
  </div>
</main>

<!-- 함께 참여하기 버튼 -->
<div class="fixed-participate-btn">
  <a href="./exp01_share.html?type=plogging" class="participate-btn">
    <i class="ri-add-line"></i>
    함께 참여하기
  </a>
</div>

<!-- Footer -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-col brand-col">
      <div class="brand">
        <img src="./assets/logo.png" alt="RIPPLE 로고" class="ripple-logo-footer"> 
      </div>
      <p class="brand-sub">더 나은 세상을 위한 제안</p>
      <div class="socials">
        <a class="social" href="#" aria-label="Instagram"><i class="ri-instagram-line"></i></a>
        <a class="social" href="#" aria-label="YouTube"><i class="ri-youtube-line"></i></a>
        <a class="social" href="#" aria-label="X"><i class="ri-twitter-x-line"></i></a>
        <a class="social" href="#" aria-label="Email"><i class="ri-mail-line"></i></a>
      </div>
      <p class="legal">© 2025 RIPPLE. All rights reserved. contact@rpl.app</p>
    </div>

    <!-- 오른쪽: 메뉴 -->
    <div class="footer-right">
      <ul class="links-list">
        <li><a href="#home">HOME</a></li>
        <li><a href="#about">ABOUT</a></li>
        <li><a href="#guide">GUIDE</a></li>
        <li><a href="#experience">EXPERIENCE</a></li>
      </ul>
    </div>
  </div>
</footer>

  <script src="./script.js"></script>
  <script>
    // 페이지 로드 시 localStorage에서 게시물 불러오기
    document.addEventListener('DOMContentLoaded', function() {
      // 약간의 지연을 두어 기존 카드들이 먼저 렌더링되도록 함
      setTimeout(function() {
        loadNewPostsFromStorage();
      }, 100);
    });

    function loadNewPostsFromStorage() {
      const posts = JSON.parse(localStorage.getItem('ploggingPosts') || '[]');
      const expGrid = document.querySelector('.exp-grid');
      
      if (!expGrid) {
        console.log('Exp grid not found');
        return;
      }
      
      // 기존에 추가된 동적 카드들 제거 (original-로 시작하지 않는 카드들)
      const dynamicCards = expGrid.querySelectorAll('.exp-card:not([data-post-id^="original-"])');
      dynamicCards.forEach(card => card.remove());
      
      console.log('Loaded posts from storage:', posts);
      
      // 모든 게시물을 최신순으로 정렬하여 다시 추가
      if (posts.length > 0) {
        // 게시물을 최신순으로 정렬 (ID가 큰 것이 최신)
        const sortedPosts = posts
          .filter(post => post.id && typeof post.id === 'number')
          .sort((a, b) => b.id - a.id); // ID 내림차순 정렬 (최신순)
        
        console.log('Sorted posts (newest first):', sortedPosts);
        
        // 최신순으로 첫 번째에 추가 (역순으로 추가하여 최신이 맨 앞에 오도록)
        for (let i = sortedPosts.length - 1; i >= 0; i--) {
          const post = sortedPosts[i];
          const newCard = createCardElement(post);
          newCard.setAttribute('data-post-id', post.id);
          // 첫 번째 자식 요소 앞에 추가
          const firstChild = expGrid.firstElementChild;
          if (firstChild) {
            expGrid.insertBefore(newCard, firstChild);
          } else {
            expGrid.appendChild(newCard);
          }
          console.log('New card added at first position:', post.title);
        }
      }
    }

    function createCardElement(post) {
      const card = document.createElement('a');
      card.href = `./exp-detail01.html?type=plogging&id=${encodeURIComponent(post.id)}`;
      card.className = 'exp-card';
      card.setAttribute('data-post-id', post.id);
      card.addEventListener('click', function(e) {
        // 클릭한 게시물의 ID를 localStorage에 저장
        localStorage.setItem('selectedPostId', post.id);
      });
      card.innerHTML = createCardHTML(post);
      return card;
    }

    function createCardHTML(post) {
      const titleText = post.title || post.tags || '새로운 활동';
      const contentText = post.content || '';
      
      // 이미지가 있는 경우와 없는 경우를 구분
      if (post.image) {
        return `
          <img src="${post.image}" alt="플로깅 활동" class="exp-card__img">
          <span class="exp-card__tag">${titleText}</span>
          <div class="exp-card__rule"></div>
        `;
      } else {
        return `
          <div class="exp-card__text-content">
            <p class="exp-card__description-text">${contentText}</p>
          </div>
          <span class="exp-card__tag">${titleText}</span>
          <div class="exp-card__rule"></div>
        `;
      }
    }
  </script>
</body>
</html>